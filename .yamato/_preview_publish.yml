auto-version:
    name: Auto version
    agent:
        type: Unity::VM
        image: package-ci/ubuntu:stable
        flavor: b1.large
    variables:
        PATH: /home/bokken/bin:/home/bokken/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/sbin:/home/bokken/.npm-global/bin
        DISPLAY: ":0"
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci utils auto-version bump --package-path com.unity.render-pipelines.core --package-path com.unity.render-pipelines.universal --package-path com.unity.render-pipelines.high-definition --package-path com.unity.shadergraph --package-path com.unity.visualeffectgraph --package-path com.unity.render-pipelines.high-definition-config --package-path com.unity.render-pipelines.lightweight
      -  upm-ci utils auto-version commit --push
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
    triggers:
        branches:
            only:
              -  master
publish_core:
    name: '[core] Candidates Publish'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    dependencies:
      -  .yamato/_packages.yml#pack_core
      -  .yamato/_abv.yml#all_project_ci_nightly_trunk
      -  .yamato/_packages.yml#test_core_mac_trunk
      -  .yamato/_packages.yml#test_core_win_trunk
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package publish --package-path com.unity.render-pipelines.core
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
    triggers:
        recurring:
          -  branch: master
             frequency: daily
promote_core:
    name: '[core] Production Promote'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    variables:
        UPMCI_PROMOTION: 1
    dependencies:
      -  .yamato/_packages.yml#pack_core
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package promote --package-path com.unity.render-pipelines.core
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
publish_universal:
    name: '[universal] Candidates Publish'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    dependencies:
      -  .yamato/_packages.yml#pack_universal
      -  .yamato/_abv.yml#all_project_ci_nightly_trunk
      -  .yamato/_packages.yml#test_universal_mac_trunk
      -  .yamato/_packages.yml#test_universal_win_trunk
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package publish --package-path com.unity.render-pipelines.universal
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
    triggers:
        recurring:
          -  branch: master
             frequency: daily
promote_universal:
    name: '[universal] Production Promote'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    variables:
        UPMCI_PROMOTION: 1
    dependencies:
      -  .yamato/_packages.yml#pack_universal
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package promote --package-path com.unity.render-pipelines.universal
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
publish_hdrp:
    name: '[hdrp] Candidates Publish'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    dependencies:
      -  .yamato/_packages.yml#pack_hdrp
      -  .yamato/_abv.yml#all_project_ci_nightly_trunk
      -  .yamato/_packages.yml#test_hdrp_mac_trunk
      -  .yamato/_packages.yml#test_hdrp_win_trunk
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package publish --package-path com.unity.render-pipelines.high-definition
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
    triggers:
        recurring:
          -  branch: master
             frequency: daily
promote_hdrp:
    name: '[hdrp] Production Promote'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    variables:
        UPMCI_PROMOTION: 1
    dependencies:
      -  .yamato/_packages.yml#pack_hdrp
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package promote --package-path com.unity.render-pipelines.high-definition
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
publish_shadergraph:
    name: '[shadergraph] Candidates Publish'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    dependencies:
      -  .yamato/_packages.yml#pack_shadergraph
      -  .yamato/_abv.yml#all_project_ci_nightly_trunk
      -  .yamato/_packages.yml#test_shadergraph_mac_trunk
      -  .yamato/_packages.yml#test_shadergraph_win_trunk
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package publish --package-path com.unity.shadergraph
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
    triggers:
        recurring:
          -  branch: master
             frequency: daily
promote_shadergraph:
    name: '[shadergraph] Production Promote'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    variables:
        UPMCI_PROMOTION: 1
    dependencies:
      -  .yamato/_packages.yml#pack_shadergraph
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package promote --package-path com.unity.shadergraph
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
publish_vfx:
    name: '[vfx] Candidates Publish'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    dependencies:
      -  .yamato/_packages.yml#pack_vfx
      -  .yamato/_abv.yml#all_project_ci_nightly_trunk
      -  .yamato/_packages.yml#test_vfx_mac_trunk
      -  .yamato/_packages.yml#test_vfx_win_trunk
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package publish --package-path com.unity.visualeffectgraph
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
    triggers:
        recurring:
          -  branch: master
             frequency: daily
promote_vfx:
    name: '[vfx] Production Promote'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    variables:
        UPMCI_PROMOTION: 1
    dependencies:
      -  .yamato/_packages.yml#pack_vfx
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package promote --package-path com.unity.visualeffectgraph
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
publish_config:
    name: '[config] Candidates Publish'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    dependencies:
      -  .yamato/_packages.yml#pack_config
      -  .yamato/_abv.yml#all_project_ci_nightly_trunk
      -  .yamato/_packages.yml#test_config_mac_trunk
      -  .yamato/_packages.yml#test_config_win_trunk
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package publish --package-path com.unity.render-pipelines.high-definition-config
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
    triggers:
        recurring:
          -  branch: master
             frequency: daily
promote_config:
    name: '[config] Production Promote'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    variables:
        UPMCI_PROMOTION: 1
    dependencies:
      -  .yamato/_packages.yml#pack_config
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package promote --package-path com.unity.render-pipelines.high-definition-config
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
publish_lwrp:
    name: '[lwrp] Candidates Publish'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    dependencies:
      -  .yamato/_packages.yml#pack_lwrp
      -  .yamato/_abv.yml#all_project_ci_nightly_trunk
      -  .yamato/_packages.yml#test_lwrp_mac_trunk
      -  .yamato/_packages.yml#test_lwrp_win_trunk
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package publish --package-path com.unity.render-pipelines.lightweight
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
    triggers:
        recurring:
          -  branch: master
             frequency: daily
promote_lwrp:
    name: '[lwrp] Production Promote'
    agent:
        type: Unity::VM
        image: package-ci/win10:stable
        flavor: b1.large
    variables:
        UPMCI_PROMOTION: 1
    dependencies:
      -  .yamato/_packages.yml#pack_lwrp
    commands:
      -  npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
      -  upm-ci package promote --package-path com.unity.render-pipelines.lightweight
    artifacts:
        packages:
            paths:
              -  "upm-ci~/packages/**/*"
